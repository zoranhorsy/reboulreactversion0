"use strict";(()=>{var g=(n,e)=>()=>(e||n((e={exports:{}}).exports,e),e.exports);var f=g(()=>{var c=0;function d(n,e){return n.filter(r=>{if(e.categories?.length){let s=String(r.category_id||"");if(!e.categories.some(t=>t===s))return!1}if(e.brands?.length){let s=String(r.brand_id||"");if(!e.brands.some(t=>t===s))return!1}if(e.priceRange&&(r.price<e.priceRange.min||r.price>e.priceRange.max))return!1;if(e.sizes?.length&&r.variants){let s=r.variants.map(t=>t.size).filter(Boolean);if(!e.sizes.some(t=>s.includes(t)))return!1}if(e.colors?.length&&r.variants){let s=r.variants.map(t=>t.color?.toLowerCase()).filter(Boolean);if(!e.colors.some(t=>s.includes(t.toLowerCase())))return!1}if(e.inStock!==void 0){if(r.variants&&r.variants.length>0){let s=r.variants.some(t=>(t.stock||0)>0);if(e.inStock!==s)return!1}else if(e.inStock!==!!r.inStock)return!1}if(e.searchTerm){let s=e.searchTerm.toLowerCase();return r.name.toLowerCase().includes(s)||r.brand&&r.brand.toLowerCase().includes(s)||r.description&&r.description.toLowerCase().includes(s)}return!0})}function u(n,e,r){let s=[...n],t=r==="asc"?1:-1;return s.sort((a,i)=>{if(e==="price")return(a.price-i.price)*t;if(e==="name")return a.name.localeCompare(i.name)*t;if(e==="newest"){let o=new Date(a.created_at||0).getTime();return new Date(i.created_at||0).getTime()-o}else if(e==="popular"){let o=a.popularity||0;return(i.popularity||0)-o}return 0})}self.onmessage=n=>{let e=n.data;c=performance.now();try{switch(e.type){case"FILTER_PRODUCTS":{let r=d(e.products,e.options),s=performance.now()-c;self.postMessage({type:"FILTER_SUCCESS",taskId:e.taskId,result:r,processingTime:s});break}case"SORT_PRODUCTS":{let r=u(e.products,e.sortBy,e.sortOrder),s=performance.now()-c;self.postMessage({type:"SORT_SUCCESS",taskId:e.taskId,result:r,processingTime:s});break}default:self.postMessage({type:"ERROR",taskId:e.taskId||"unknown",error:"Type de message non support\xE9"})}}catch(r){self.postMessage({type:"ERROR",taskId:e.taskId||"unknown",error:r instanceof Error?r.message:"Erreur inconnue"})}}});f();})();
//# sourceMappingURL=filterWorker.js.map
