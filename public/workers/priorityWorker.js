"use strict";(()=>{var n=(s,e)=>()=>(e||s((e={exports:{}}).exports,e),e.exports);var g=n(()=>{var t=[];function c(s){let e={high:0,medium:1,low:2};return[...s].sort((r,a)=>e[r.priority]-e[a.priority])}async function u(s){switch(s.type){case"IMAGE_OPTIMIZATION":return i(s.data);case"DATA_AGGREGATION":return d(s.data);case"PRODUCT_RECOMMENDATIONS":return y(s.data);case"USER_PREFERENCES":return m(s.data);default:return await new Promise(e=>setTimeout(e,100)),{success:!0,data:`T\xE2che ${s.id} de type ${s.type} trait\xE9e avec succ\xE8s`}}}async function i(s){try{return await new Promise(e=>setTimeout(e,300)),{success:!0,data:{url:s.url,optimized:!0,size:s.size?Math.floor(s.size*.7):100,format:s.format||"webp"}}}catch(e){return{success:!1,data:e instanceof Error?e.message:"Erreur inconnue"}}}async function d(s){try{if(await new Promise(e=>setTimeout(e,200)),Array.isArray(s.items)){let e=s.items.reduce((r,a)=>{let o=a[s.groupBy||"id"];return r[o]||(r[o]=[]),r[o].push(a),r},{});return{success:!0,data:{aggregated:!0,result:e,count:Object.keys(e).length}}}return{success:!0,data:{aggregated:!0,message:"Donn\xE9es agr\xE9g\xE9es avec succ\xE8s"}}}catch(e){return{success:!1,data:e instanceof Error?e.message:"Erreur inconnue"}}}async function y(s){try{return await new Promise(e=>setTimeout(e,400)),s.productId?{success:!0,data:{recommendations:[{id:"rec1",score:.92,reason:"similar"},{id:"rec2",score:.85,reason:"bought_together"},{id:"rec3",score:.78,reason:"viewed_also_viewed"}],source:`Product ${s.productId}`}}:s.userId?{success:!0,data:{recommendations:[{id:"urec1",score:.89,reason:"purchase_history"},{id:"urec2",score:.74,reason:"viewed_recently"},{id:"urec3",score:.67,reason:"wishlist"}],source:`User ${s.userId}`}}:{success:!0,data:{recommendations:[],message:"Aucun contexte pour g\xE9n\xE9rer des recommandations"}}}catch(e){return{success:!1,data:e instanceof Error?e.message:"Erreur inconnue"}}}async function m(s){try{return await new Promise(e=>setTimeout(e,150)),{success:!0,data:{processed:!0,preferences:{...s},recommendations:{categories:s.categories||[],brands:s.brands||[]}}}}catch(e){return{success:!1,data:e instanceof Error?e.message:"Erreur inconnue"}}}async function p(){if(t.length===0){self.postMessage({type:"QUEUE_EMPTY"});return}let s=c(t);for(let e of s)try{let r=await u(e);self.postMessage({type:"TASK_COMPLETE",taskId:e.id,result:r})}catch(r){self.postMessage({type:"TASK_ERROR",taskId:e.id,error:r instanceof Error?r.message:"Erreur inconnue"})}t.length=0}self.onmessage=s=>{let e=s.data;try{switch(e.type){case"ADD_TASK":e.task&&(t.push(e.task),self.postMessage({type:"TASK_ADDED",taskId:e.task.id}));break;case"PROCESS_TASKS":p();break;case"CLEAR_QUEUE":t.length=0,self.postMessage({type:"QUEUE_CLEARED"});break;default:self.postMessage({type:"ERROR",error:"Type de message non support\xE9"})}}catch(r){self.postMessage({type:"ERROR",error:r instanceof Error?r.message:"Erreur inconnue"})}}});g();})();
//# sourceMappingURL=priorityWorker.js.map
